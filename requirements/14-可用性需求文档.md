# 可用性需求文档（Availability Requirements）

## 1. 文档信息
- 文档名称：可用性需求文档
- 版本号：v1.0.0
- 创建日期：2025-12-09
- 最后更新：2025-12-09
- 作者：技术/运维团队
- 状态：草稿

## 2. 目标与范围
- 目标：定义 MVP 阶段的可用性目标、探活、容错与恢复要求，确保核心服务稳定可用。
- 范围：后端服务、数据库、缓存（可选）、外部依赖的可用性策略。

## 3. 可用性指标（MVP）
- SLA：99.5%（单区单活）
- 核心接口可用性：与 SLA 对齐；健康检查可用
- 恢复时间目标（RTO）：< 1 小时（单节点重启/配置恢复）
- 数据恢复点目标（RPO）：日级（MVP 占位，依赖备份策略）
- 错误预算（占位）：月度允许不可用时间 ≈ 3.6 小时（99.5%）；超预算需评审与纠偏

## 4. 探活与监控
- 健康检查：/actuator/health 或 /api/health 返回 UP
- 监控：基础指标（QPS、错误率、响应时间），外部依赖失败率
- 告警（占位阈值示例）：健康检查失败；5xx >0.5%（5 分钟）；核心接口 P95 >1.2s（5 分钟）；外部依赖失败率 >5%

## 5. 容错与降级
- 单节点容错：服务异常可重启；接口错误需可追踪
- 外部依赖：超时/重试，失败降级（AI/搜索可提示手动）
- 缓存/对象存储：不可用时需有兜底提示；不影响核心记录功能（尽量）

## 6. 变更与维护
- 维护窗口：可公告短时维护；避免高峰变更
- 配置变更：使用环境变量/配置文件，支持回滚
- 日志与审计：变更记录与回滚手段

## 7. 备份与恢复（占位）
- 数据库：建议日级备份（全量/增量），演练恢复流程（后续完善）
- 对象存储：原图/封面保持冗余或至少单副本存储；删除/覆盖需谨慎
- 配置：关键配置（但不含密钥）版本化；密钥安全存储

## 8. 灾备（MVP 占位）
- 当前单区单活，无多活要求；若需要跨区，需新增设计（网络/数据同步/切换策略）
- 故障切换预案：同机房重启/替换节点；跨区/多活后续单独设计

## 9. 验收
- 健康检查可用；故障模拟（服务重启）后可恢复
- 核心接口无高频 5xx；外部依赖失败时有明确降级/提示

## 10. 变更与版本
- 可用性策略调整需记录；版本按 vX.Y.Z 递增

