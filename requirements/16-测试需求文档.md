# 测试需求文档（Test Requirements）

## 1. 文档信息
- 文档名称：测试需求文档
- 版本号：v1.0.0
- 创建日期：2025-12-09
- 最后更新：2025-12-09
- 作者：测试团队
- 状态：草稿

## 2. 目的与范围
- 目的：明确 MVP 阶段的测试范围、类型、环境、数据、工具与覆盖要求，确保产品质量达标。
- 范围：后端 REST 接口（认证、摄影/影视/音乐/球赛、AI 标签、搜索、时间线/统计、推荐/总结）、非功能（性能/安全/可用性）、兼容性与回归。

## 3. 参考文档
- 《01-需求调研文档》《02-需求分析文档》《03-BRD》《04-PRD》《06-IxD》《07-TRD》《10-接口需求文档》《11-DDD》《12-性能需求文档》《13-安全需求文档》《14-可用性需求文档》《15-运维需求文档》

## 4. 测试范围
- 功能：登录注册、上传/创建/编辑/删除、搜索（TMDB/Last.fm）、AI 标签（免费方案）、时间线/统计、推荐/总结（如开启）、权限/越权。
- 数据：字段校验、标签/评分/状态枚举、EXIF 解析、第三方 ID 去重。
- 非功能：性能（关键接口 P95）、安全（鉴权/越权/输入/上传）、可用性（探活、降级兜底）、运维（日志/监控/备份占位验证）。

## 5. 测试类型与优先级
- 功能测试（Must）：核心流程、边界、异常、兜底。
- 接口测试（Must）：REST 接口契约、错误码、分页、鉴权。
- 兼容性（Should）：主流浏览器接口兼容；基础移动端可用性（非深度）。
- 性能（Must）：上传/列表/时间线/搜索/AI 标签（可打桩）；P95<800ms。
- 安全（Must）：登录/鉴权/越权/参数校验/上传校验；日志脱敏抽查。
- 可用性（Should）：健康检查、降级（外部失败时手动兜底）。
- 回归（Must）：每次发布前关键路径回归。
- 冒烟（Must）：健康、登录、上传、列表、搜索、AI 标签（可打桩）。

## 6. 测试环境
- 环境：dev / prod（或 stage）；配置与生产相近（DB/Redis/外部 Key）
- 数据：准备测试账号、基础数据（标签/样例记录）、模拟文件（JPG/PNG）、占位搜索词
- 开关：付费 AI 关闭；免费 AI 开启；可配置打桩/Mock 外部
- 依赖：TMDB/Last.fm Key、免费 AI Key（HF/Gemini），可选 Mock

## 7. 测试数据要求
- 账号：普通用户、管理员各 1+；异常账号（禁用/过期 Token）
- 文件：合法 JPG/PNG（小/大/接近 10MB），非法格式/超限
- 记录：包含不同状态/评分/标签/时间分布的数据集；重复 tmdb_id/lastfm_id 场景
- 时间线/统计：覆盖跨周/月数据，验证统计口径

## 8. 测试工具与方式
- 接口：Postman/Apifox/RestClient
- 自动化（可选）：API 自动化脚本（占位）
- 压测：JMeter/k6（与性能文档一致）
- Mock：必要时对 TMDB/Last.fm/AI 打桩，验证降级

## 9. 覆盖要求
- 功能用例覆盖率：核心 Must 100%，Should ≥90%
- 接口用例：核心接口正常+异常+鉴权+越权必测
- 性能：关键接口压测场景至少 1 轮；指标达成
- 安全：鉴权/越权/输入/上传校验必测；日志脱敏抽查
- 回归：每次发版前关键路径回归

## 10. 出入条件
- 进入：需求/设计冻结；接口契约稳定；环境/Key 配置就绪；测试数据准备
- 退出：Must 用例全通过；Should 通过率≥90%；P95 达标；安全/越权无阻塞；主要缺陷已关闭或有可接受的 WA

## 11. 交付物
- 测试用例（本库《17-测试用例文档》）
- 测试报告（执行结果、缺陷统计、风险）
- 压测报告（如执行）
- 回归结果记录

## 12. 风险与应对
- 外部依赖不稳定：预备 Mock/打桩；失败兜底流程验证
- 配额/成本：免费 API 额度监控；付费 AI 关闭
- 进度：Must/Should 分层；缺陷优先级管理

## 13. 版本
- v1.0.0：首版（MVP 测试需求）

